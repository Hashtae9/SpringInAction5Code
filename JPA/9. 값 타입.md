# ê°’ íƒ€ì…

### JPA ê°’ íƒ€ì…ì€ í¬ê²Œ 3ê°€ì§€ë¡œ êµ¬ë¶„

+ êµ¬ë¶„ê°’ íƒ€ì…(basic value type)
  + ìë°” ê¸°ë³¸ íƒ€ì…(int, double)
  + ë˜í¼ í´ë˜ìŠ¤(Integer)
  + String
+ ì„ë² ë””ë“œ íƒ€ì…(embedded type) / ë³µí•© ê°’ íƒ€ì…
+ ì»¬ë ‰ì…˜ íƒ€ì…(collection value type)



## 1. ê¸°ë³¸ê°’ íƒ€ì…

```java
@Entity
public class Member {
		@Id @GeneratedValue
		private Long id;

		private String name;
		private int age;
		...
}
```

+ Member ì—”í‹°í‹°ì˜ name, ageì™€ ê°™ì´ ì‹ë³„ì ê°’ë„ ì—†ê³  ìƒëª…ì£¼ê¸°ë„ íšŒì› ì—”í‹°í‹°ì— ì˜ì¡´í•˜ëŠ” ê°’



## 2. ì„ë² ë””ë“œ íƒ€ì…(ë³µí•© ê°’ íƒ€ì…)

> ìƒˆë¡œìš´ ê°’ íƒ€ì…ì„ ì§ì ‘ ì •ì˜í•´ì„œ ì‚¬ìš© ê°€ëŠ¥, JPAì—ì„  ì´ê²ƒì„ ì„ë² ë””ë“œ íƒ€ì…ì´ë€ ë‹¨ì–´ë¡œ ì‚¬ìš©
>
> > ì§ì ‘ ì •ì˜í•œ ì„ë² ë””ë“œ íƒ€ì…ë„ int, String ì²˜ëŸ¼ ê°’ íƒ€ì…



```java
//ê¸°ë³¸ íšŒì› ì—”í‹°í‹°
@Entity
public class Member {
		@Id @GeneratedValue
		private Long id;
		private String name;
		
		//ê·¼ë¬´ê¸°ê°„
		@Temporal(TemporalType.DATE) java.util.Date startDate;
		@Temporal(TemporalType.DATE) java.util.Date endDate;
		
		//ì£¼ì†Œ
		private String city;
		private String street;
		private String zipcode;
	...
}

// ê°’ íƒ€ì… ì ìš© íšŒì› ì—”í‹°í‹°
@Entity
public class Member {
		
    	@Id @GeneratedValue
		private Long id;
		private String name;
    
		@Embedded Period workPeriod; //ê·¼ë¬´ ê¸°ê°„
		@Embedded Address homeAddress; //ì§‘ ì£¼ì†Œ
		...
}

@Embeddable
public class Period {
		@Temporal(TemporalType.DATE) java.util.Date startDate;
		@Temporal(TemporalType.DATE) java.util.Date endDate;
		...
}

@Embeddable
public class Address {
		@Column(name="city") //ë§¤í•‘ ì»¬ëŸ¼ ì •ì˜ ê°€ëŠ¥
		private String city;
		private String street;
		private String zipcode;
		...
}
```

- ì„ë² ë””ë“œ íƒ€ì…ì„ ì‚¬ìš©í•˜ë ¤ë©´ 2ê°€ì§€ ì–´ë…¸í…Œì´ì…˜ì´ í•„ìš”, ë‘˜ ì¤‘ í•˜ë‚˜ëŠ” ìƒëµ ê°€ëŠ¥

  - @Embeddable: ê°’ íƒ€ì…ì„ ì •ì˜í•˜ëŠ” ê³³ì— í‘œì‹œ

  - @Embedded: ê°’ íƒ€ì…ì„ ì‚¬ìš©í•˜ëŠ” ê³³ì— í‘œì‹œ



### ì„ë² ë””ë“œ íƒ€ì…ê³¼ í…Œì´ë¸” ë§¤í•‘

<img src="https://user-images.githubusercontent.com/101400894/178198007-6f79f9c3-ef85-43fa-8e44-32dd2b2a89b1.png" alt="image" style="zoom:80%;" align="left"/>

- ì„ë² ë””ë“œ íƒ€ì…ì€ ì—”í‹°í‹°ì˜ ê°’ì¼ ë¿

- ì„ë² ë””ë“œ íƒ€ì…ì„ ì‚¬ìš©í•˜ê¸° ì „ê³¼ í›„ì— ë§¤í•‘í•˜ëŠ” í…Œì´ë¸”ì€ ë™ì¼

- ì„ë² ë””ë“œ íƒ€ì…ìœ¼ë¡œ í…Œì´ë¸”ì„ ì„¸ë°€í•˜ê²Œ ë§¤í•‘ì´ ê°€ëŠ¥
  - ì˜ ì„¤ê³„í•œ ORM ì• í”Œë¦¬ì¼€ì´ì…˜ì€ ë§¤í•‘í•œ í…Œì´ë¸”ì˜ ìˆ˜ë³´ë‹¤ í´ë˜ìŠ¤ì˜ ìˆ˜ê°€ ë§ìŒ



### ì„ë² ë””ë“œ íƒ€ì…ê³¼ ì—°ê´€ê´€ê³„

<img src="https://user-images.githubusercontent.com/101400894/178198125-457eb77b-0d85-4ae8-b5b4-e92be7236cf6.png" alt="image" style="zoom:80%;" align="left"/>

```java
@Entity
public class Member {
		@Embedded Address address; //ì„ë² ë””ë“œ íƒ€ì… í¬í•¨
		@Embedded PhoneNumber phoneNumber; //ì„ë² ë””ë“œ íƒ€ì… í¬í•¨
}

@Embeddable
public class Address {
		...
		@Embedded Zipcode zipcode; //ì„ë² ë””ë“œ íƒ€ì… í¬í•¨
}

@Embeddable
public class Zipcode {
		String zip;
		String plusFour;
}

@Embeddable
public class PhoneNumber {
		String areaCode;
		String localNumber;
		@ManyToOne PhoneEntity provider; //ì—”í‹°í‹° ì°¸ì¡°
}

@Entity
public class PhoneEntity {
		@Id String name; 
		...
}
```

+ Addressê°€ ê°’ íƒ€ì…ì¸ Zipcodeë¥¼ í¬í•¨
+ PhoneNumberê°€ ì—”í‹°í‹° íƒ€ì…ì¸ PhoneEntityë¥¼ ì°¸ì¡°



#### @AttributeOverride : ì†ì„± ì¬ì •ì˜

> ì„ë² ë””ë“œ íƒ€ì…ì— ë§¤í•‘ì •ë³´ë¥¼ ì¬ì •ì˜í•  ë•Œ @AttributeOverrideë¥¼ ì‚¬ìš©

```java
//ê°™ì€ ì„ë² ë””ë“œ íƒ€ì…ì„ ê°–ëŠ” íšŒì›
@Entity
public class Member {
		@Id @GeneratedValue
		private Long id;
		
		...

		@Embedded Address homeAddress;
		@Embedded Address companyAddress;
}

//ì„ë² ë””ë“œ íƒ€ì… ì¬ì •ì˜
@Entity
public class Member {
		@Id @GeneratedValue
		private Long id;
		
		...

		@Embedded Address homeAddress;

		@Embedded 
		@AttributeOverrides({
				@AttributeOverride(name = "city"
								, column = @Column(name = "COMPANY_CITY")),
				@AttributeOverride(name = "street"
								, column = @Column(name = "COMPANY_STREET")),
				@AttributeOverride(name = "zipcode"
								, column = @Column(name = "COMPANY_ZIPCODE"))
		})
		Address companyAddress;
}


//ìƒì„± í…Œì´ë¸” DDL
CREATE TABLE MEMBER (
		COMPANY_CITY varchar(255),
		COMPANY_STREET varchar(255),
		COMPANY_ZIPCODE varchar(255),
		city varchar(255),
		street varchar(255),
		zipcode varchar(255),
		...
)
```

+ Addressê°€ í•˜ë‚˜ ë” ì¶”ê°€ë¨ìœ¼ë¡œì¨ í…Œì´ë¸”ì— ë§¤í•‘í•˜ëŠ” ì»¬ëŸ¼ëª…ì´ ì¤‘ë³µë˜ê¸° ë•Œë¬¸ì— í•˜ë‚˜ëŠ” ì¬ì •ì˜ í•´ì¤˜ì•¼ í•¨.



#### ì„ë² ë””ë“œ íƒ€ì…ê³¼ null

> ì„ë² ë””ë“œ íƒ€ì…ì´ nullì´ë©´ ë§¤í•‘í•œ ì»¬ëŸ¼ ê°’ì€ ëª¨ë‘ null

```java
member.setAddress(null); //null ì…ë ¥
em.persist(member);

//city, street, zipcode ì»¬ëŸ¼ ëª¨ë‘ null
```



## 3. ê°’ íƒ€ì…ê³¼ ë¶ˆë³€ ê°ì²´

> ê°’ íƒ€ì…ì€ ë‹¨ìˆœí•˜ê³  ì•ˆì „í•˜ê²Œ ë‹¤ë¤„ì•¼ í•¨



### ê°’ íƒ€ì… ê³µìœ  ì°¸ì¡°

> ì„ë² ë””ë“œ íƒ€ì… ê°™ì€ ê°’ íƒ€ì…ì„ ì—¬ëŸ¬ ì—”í‹°í‹°ì— ê³µìœ í•˜ë©´ ìœ„í—˜

<img src="https://user-images.githubusercontent.com/101400894/178200550-8500bf00-552a-4334-b945-93a0945be288.png" alt="image" style="zoom:80%;" align="left"/>

```java
member1.setHomeAddress(new Address("OldCity"));
Address address = member1.getHomeAddress();

address.setCity("NewCity"); //íšŒì› 1ì˜ address ê°’ì„ ê³µìœ í•´ì„œ ì‚¬ìš©
member2.setHomeAddress(address);
```

- íšŒì› 2ì˜ ì£¼ì†Œë§Œ "NewCity"ë¡œ ë³€ê²½ë˜ê¸¸ ê¸°ëŒ€í–ˆì§€ë§Œ íšŒì› 1ì˜ ì£¼ì†Œë„ ê°™ì´ ë³€ê²½

- ê°™ì€ address ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì°¸ì¡°í•˜ê¸° ë•Œë¬¸ì— ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ëŠ” ì†ì„±ì´ ë³€ê²½ëœ ê²ƒìœ¼ë¡œ íŒë‹¨

- ì´ëŸ° ë¶€ì‘ìš©ì„ ë§‰ìœ¼ë ¤ë©´ ê°’ì„ ë³µì‚¬í•´ì„œ ì‚¬ìš©



### ê°’ íƒ€ì… ë³µì‚¬

> ì‹¤ì œ ì¸ìŠ¤í„´ìŠ¤ì¸ ê°’ì„ ê³µìœ í•˜ëŠ” ê²ƒì€ ìœ„í—˜, ëŒ€ì‹ ì— ê°’ì„ ë³µì‚¬í•´ì„œ ì‚¬ìš©

<img src="https://user-images.githubusercontent.com/101400894/178201141-a0ec93a4-50d8-422e-8b11-33f660c8d4c9.png" alt="image" style="zoom:80%;" align="left"/>

```java
member1.setHomeAddress(new Address("OldCity"));
Address address = member1.getHomeAddress();

//íšŒì›1ì˜ Addressê°’ì„ ë³µì‚¬í•´ì„œ ìƒˆë¡œìš´ newAddress ê°’ì„ ìƒì„±
Address newAddress = address.clone();

newAddress.setCity("NewCity");
member2.setHomeAddress(newAddress);
```

+ ë‚˜ì¤‘ì— ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ëŠ” íšŒì› 2ì˜ ì£¼ì†Œë§Œ ë³€ê²½ëœ ê²ƒìœ¼ë¡œ í™•ì¸í•˜ê³  íšŒì› 2ì— ëŒ€í•´ì„œë§Œ UPDATE SQLì„ ì‹¤í–‰



```java
//ì°¸ì¡°ê°’ì„ ì „ë‹¬
Address a = new Address("Old");
Address b = a;
b.setCity("New");

//ë³µì‚¬ê°’ì„ ì „ë‹¬
Address a = new Address("Old");
Address b = a.clone(); //ë³µì‚¬í•´ì„œ ê°’ì„ ë„˜ê¹€
b.setCity("New");
```

+ **ê°ì²´íƒ€ì…ì€ ê°’ì„ ëŒ€ì…í•˜ë©´ í•­ìƒ ì°¸ì¡°ê°’ì„ ì „ë‹¬**



### ë¶ˆë³€ ê°ì²´

> í•œ ë²ˆ ë§Œë“¤ë©´ ì ˆëŒ€ ë³€ê²½í•  ìˆ˜ ì—†ëŠ” ê°ì²´

- ê°ì²´ë¥¼ ë¶ˆë³€í•˜ê²Œ ë§Œë“¤ë©´ ìˆ˜ì •í•  ìˆ˜ ì—†ìœ¼ë¯€ë¡œ ë¶€ì‘ìš©ì„ ì›ì²œ ì°¨ë‹¨

- **ê°’ íƒ€ì…ì€ ë  ìˆ˜ ìˆìœ¼ë©´ ë¶ˆë³€ ê°ì²´ë¡œ ì„¤ê³„**

- ë¶ˆë³€ ê°ì²´ë¥¼ êµ¬í˜„í•˜ëŠ” ê°€ì¥ ê°„ë‹¨í•œ ë°©ë²•ì€ ìƒì„±ìë¡œë§Œ ê°’ì„ ì„¤ì •, ìˆ˜ì •ìëŠ” X

- **ë¶ˆë³€ì´ë¼ëŠ” ì‘ì€ ì œì•½ìœ¼ë¡œ ë¶€ì‘ìš©ì´ë¼ëŠ” í° ì¬ì•™ì„ ë°©ì§€**

```java
//ë¶ˆë³€ ê°ì²´ ìƒì„±
@Embeddable
public class Address {
		private String city;
		protected Address() {} //JPAì—ì„  ê¸°ë³¸ ìƒì„±ì í•„ìˆ˜

		//ìƒì„±ìë¡œ ì´ˆê¸° ê°’ ì„¤ì •
		public Address(String city) {
				this.city = city;
		}
		
		//setter ì—†ì´ getterë§Œ ì„¤ì •
		public String getCity() {
				return city;
		}
}

//ë¶ˆë³€ ê°ì²´ ì‚¬ìš©
Address address = member1.getHomeAddress();
Address newAddress = new Address(address.getCity());
member2.setHomeAddress(newAddress);
```



## ê°’ íƒ€ì…ì˜ ë¹„êµ

- ìë°”ì—ì„œ ì œê³µí•˜ëŠ” ê°ì²´ ë¹„êµëŠ” 2ê°€ì§€

  - ë™ì¼ì„±(Identity) ë¹„êµ: ì¸ìŠ¤í„´ìŠ¤ì˜ ì°¸ì¡° ê°’ì„ ë¹„êµ, == ì‚¬ìš©

  - ë™ë“±ì„±(Equivalence) ë¹„êµ: ì¸ìŠ¤í„´ìŠ¤ì˜ ê°’ì„ ë¹„êµ, equals() ì‚¬ìš©

- ê°ì²´ë¥¼ ë¹„êµí•˜ëŠ” ê²½ìš° a == bë¡œ ë™ì¼ì„±ì„ ë¹„êµí•˜ë©´ ë‹¤ë¥¸ ì¸ìŠ¤í„´ìŠ¤ ì´ë¯€ë¡œ ê²°ê³¼ëŠ” ê±°ì§“

```java
Address a = new Address("ì„œìš¸ì‹œ", "ì¢…ë¡œêµ¬", "1ë²ˆì§€");
Address b = new Address("ì„œìš¸ì‹œ", "ì¢…ë¡œêµ¬", "1ë²ˆì§€");

a == b // false
```

- ê°ì²´ ê°’ ë¹„êµëŠ” ``a.equals(b)``ê°™ì´ ë™ë“±ì„± ë¹„êµê°€ í•„ìš”, Address `equals()` ì¬ì •ì˜ í•„ìš”

  - `equals()` ë©”ì†Œë“œë¥¼ ì¬ì •ì˜í•  ë•ŒëŠ” ë³´í†µ ëª¨ë“  í•„ë“œ ê°’ì„ ë¹„êµí•˜ë„ë¡ êµ¬í˜„

  - `equlas()`ë¥¼ ì¬ì •ì˜í•˜ë©´ `hashCode()`ë„ ì¬ì •ì˜ í•˜ëŠ” ê²ƒì´ ì•ˆì „ ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ ì»¬ë ‰ì…˜(`HashSet`, `HashMap`)ì´ ì •ìƒ ë™ì‘í•˜ì§€ ì•ŠëŠ” ë¬¸ì œ ë°œìƒ



## ê°’ íƒ€ì… ì»¬ë ‰ì…˜

> ê°’ íƒ€ì…ì„ í•˜ë‚˜ ì´ìƒ ì €ì¥í•˜ë ¤ë©´ ì»¬ë ‰ì…˜ì— ë³´ê´€ í›„ `@ElementCollection`, `@CollectionTable` ì‚¬ìš©

```java
@Entity
public class Member {
		@Id @GeneratedValue
		private Long id;
		
		@Embedded
		private Address homeAddress;
		
		@ElementCollection
		@CollectionTable(name = "FAVORITE_FOODS",
				joinColumns = @JoinColumn(name = "MEMBER_ID"))
		@Column(name="FOOD_NAME")
		private Set<String> favoriteFoods = new HashSet<String>();

		@ElementCollection
		@CollectionTable(name = "ADDRESS",
				joinColumns = @JoinColumn(name = "MEMBER_ID"))
		private List<Address> addressHistory = new ArrayList<Address>();
		...
}

@Embeddable
public class Address {
		@Column
		private String city;
		private String street;
		private String zipcode;
		...
}
```

<img src="https://user-images.githubusercontent.com/101400894/178204959-2711d8aa-31ff-401b-b540-8e16fc790901.png" alt="image" style="zoom:80%;" />

<img src="https://user-images.githubusercontent.com/101400894/178205017-9a001652-8beb-4623-8e59-8ddcacb07ebc.png" alt="image" style="zoom:87%;" />

- ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤ì˜ í…Œì´ë¸”ì€ ì»¬ëŸ¼ì•ˆì— ì»¬ë ‰ì…˜ì„ í¬í•¨í•  ìˆ˜ ì—†ìŒ ë³„ë„ì˜ í…Œì´ë¸”ì„ ì¶”ê°€í•˜ê³  @CollectionTableì„ ì‚¬ìš©í•´ì„œ ì¶”ê°€ í…Œì´ë¸”ì„ ë§¤í•‘

- @CollectionTableì„ ìƒëµí•˜ë©´ ê¸°ë³¸ ê°’ì„ ì‚¬ìš©í•´ì„œ ë§¤í•‘ (ê¸°ë³¸ ê°’: {ì—”í‹°í‹°ëª…}_{ì»¬ë ‰ì…˜ ì†ì„±ëª…}, `addressHistory`ëŠ” `Member_addressHistory`ìœ¼ë¡œ ë§¤í•‘)



### ê°’ íƒ€ì… ì»¬ë ‰ì…˜ ì‚¬ìš©

**<ê°’ íƒ€ì… ì»¬ë ‰ì…˜ ë“±ë¡>**

```java
Member member = new Member();

//ì„ë² ë””ë“œ ê°’ íƒ€ì…
member.setHomeAddress(new Address("í†µì˜","ëª½ëŒí•´ìˆ˜ìš•ì¥","660-123"));

//ê¸°ë³¸ê°’ íƒ€ì… ì»¬ë ‰ì…˜
member.getFavoriteFoods().add("ì§¬ë½•");
member.getFavoriteFoods().add("ì§œì¥");
member.getFavoriteFoods().add("íƒ•ìˆ˜ìœ¡");

//ì„ë² ë””ë“œ ê°’ íƒ€ì… ì»¬ë ‰ì…˜
member.getAddressHistory().add(new Address("ì„œìš¸","ê°•ë‚¨","123-123"));
member.getAddressHistory().add(new Address("ì„œìš¸","ê°•ë¶","000-000"));

em.persist(member);

------------------------------------------------------------------
//ì‹¤í–‰ëœ SQL
INSERT INTO MEMBER(ID, CITY, STREET, ZIPCODE) VALUES (1, 'í†µì˜', 'ëª½ëŒí•´ìˆ˜ìš•ì¥', '660-123');
INSERT INTO FAVORITE_FOODS(MEMBER_ID, FOOD_NAME) VALUES (1, 'ì§¬ë½•');
INSERT INTO FAVORITE_FOODS(MEMBER_ID, FOOD_NAME) VALUES (1, 'ì§œì¥');
INSERT INTO FAVORITE_FOODS(MEMBER_ID, FOOD_NAME) VALUES (1, 'íƒ•ìˆ˜ìœ¡');

INSERT INTO ADDRESS(MEMBER_ID, CITY, STREET, ZIPCODE) 
VALUES (1, 'ì„œìš¸', 'ê°•ë‚¨', '123-123');
INSERT INTO ADDRESS(MEMBER_ID, CITY, STREET, ZIPCODE) 
VALUES (1, 'ì„œìš¸', 'ê°•ë¶', '000-000');
```

ğŸ“Œ**ê°’ íƒ€ì… ì»¬ë ‰ì…˜ì€ ì˜ì†ì„± ì „ì´(Cascade) + ê³ ì•„ ê°ì²´ ì œê±°(ORPHAN REMOVE) ê¸°ëŠ¥ì„ í•„ìˆ˜ë¡œ ê°€ì§**





**<ê°’ íƒ€ì… ì»¬ë ‰ì…˜ ì¡°íšŒ>**

ê°’ íƒ€ì… ì»¬ë ‰ì…˜ë„ ì¡°íšŒí•  ë•Œ Fetch ì „ëµ ì„ íƒ ê°€ëŠ¥, ê¸°ë³¸ì€ LAZY

- @ElementCollection(fetch = FetchType.LAZY)

```java
//SQL : SELECT ID, CITY, STREET, ZIPCODE FROM MEMBER WHERE ID = 1
Member member = em.find(Member.class, 1L); //1. member

//2. member.homeAddress
Address homeAddress = member.getHomeAddress();

//3. member.favoriteFoods
Set<String> favoriteFoods = member.getFavoriteFoods(); //LAZY

//SQL : SELECT MEMBER_ID, FOOD_NAME, FROM FAVORITE_FOODS
//WHERE MEMBER_ID = 1
for(String favoriteFood : favoriteFoods){
	System.out.println("favoriteFood = " + favoriteFood);
}

//4. member.addressHistory
List<Address> addressHistory = member.getAddressHistory(); //LAZY

//SQL : SELECT MEMBER_ID, CITY, STREET, ZIPCODE FROM ADDRESS
//WHERE MEMBER_ID = 1
addressHistory.get(0);
```

+ 1. member
     + íšŒì›ë§Œ ì¡°íšŒ
     + ê°’ íƒ€ì…ì¸ homeAddressë„ í•¨ê»˜ ì¡°íšŒ
+ 2. member.homeAddress
     + 1ë²ˆì—ì„œ íšŒì›ì„ ì¡°íšŒí•  ë•Œ ê°™ì´ ì¡°íšŒí•´ë‘ 
+ 3. member.favoriteFoods 
     + LAZYë¡œ ì„¤ì •í•´ì„œ ì‹¤ì œ ì»¬ë ‰ì…˜ì„ ì‚¬ìš©í•  ë•Œ SELECT SQLì„ 1ë²ˆ í˜¸ì¶œ
+ 4. member.addressHistory
     + LAZYë¡œ ì„¤ì •í•´ì„œ ì‹¤ì œ ì»¬ë ‰ì…˜ì„ ì‚¬ìš©í•  ë•Œ SELECT SQLì„ 1ë²ˆ í˜¸ì¶œ



**<ê°’ íƒ€ì… ì»¬ë ‰ì…˜ ìˆ˜ì •>**

```java
Member member = em.find(Member.class, 1L);

//ì„ë² ë””ë“œ ê°’ íƒ€ì… ìˆ˜ì •
//homeAddress ì„ë² ë””ë“œ ê°’ íƒ€ì…ì€ MEMBER í…Œì´ë¸”ê³¼ ë§¤í•‘ -> MEMBER í…Œì´ë¸”ë§Œ UPDATE
member.setHomeAddress(new Address("ìƒˆë¡œìš´ë„ì‹œ", "ì‹ ë„ì‹œ1", "123456"));

//ê¸°ë³¸ ê°’ íƒ€ì… ì»¬ë ‰ì…˜ ìˆ˜ì •
//ìë°”ì˜ String íƒ€ì…ì€ ìˆ˜ì • ë¶ˆê°€ -> ê¸°ì¡´ì˜ ê²ƒ("íƒ•ìˆ˜ìœ¡") ì œê±° í›„ ì¶”ê°€
Set<String> favoriteFoods = member.getFavoriteFoods();
favoriteFoods.remove("íƒ•ìˆ˜ìœ¡");
favoriteFoods.add("ì¹˜í‚¨");

//ì„ë² ë””ë“œ ê°’ íƒ€ì… ì»¬ë ‰ì…˜ ìˆ˜ì •
//ê°’ íƒ€ì… == ë¶ˆë³€
//ì»¬ë ‰ì…˜ì—ì„œ ê¸°ì¡´ ì£¼ì†Œ ì‚­ì œ í›„ ìƒˆë¡œìš´ ì£¼ì†Œ ë“±ë¡
List<Address> addressHistory = member.getAddressHistory();
addressHistory.remove(new Address("ì„œìš¸", "ê°•ë‚¨", "123123");
addressHistory.add(new Address("ì„œìš¸", "ê°•ë™", "123456");
```

- ì„ë² ë””ë“œ ê°’ íƒ€ì… ì»¬ë ‰ì…˜ ìˆ˜ì •í•  ê²½ìš° ì‚­ì œ í›„ ìƒˆë¡œìš´ ì£¼ì†Œ ë“±ë¡ Address ê°’ íƒ€ì…ì€ `equals`, `hashcode` ì¬ì •ì˜ê°€ í•„ìš” (removeì— í•„ìˆ˜)



### ê°’ íƒ€ì… ì»¬ë ‰ì…˜ì˜ ì œì•½ì‚¬í•­

> ê°’ íƒ€ì…ì€ ì‹ë³„ìë¼ëŠ” ê°œë…ì´ ì—†ì–´ ê°’ì„ ë³€ê²½í•˜ë©´ ì €ì¥ëœ ì›ë³¸ ë°ì´í„° ì°¾ê¸°ê°€ ì–´ë ¤ì›€
>
> > íŠ¹ì • ì—”í‹°í‹° í•˜ë‚˜ì— ì†Œì†ëœ ê°’ íƒ€ì…ì€ ê°’ì´ ë³€ê²½ë˜ì–´ë„ ìì‹ ì´ ì†Œì†ëœ ì—”í‹°í‹°ë¥¼ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì°¾ê³  ê°’ì„ ë³€ê²½
> >
> > ê°’ íƒ€ì… ì»¬ë ‰ì…˜ì— ë³´ê´€ëœ ê°’ íƒ€ì…ë“¤ì€ ë³„ë„ì˜ í…Œì´ë¸”ì— ë³´ê´€ -> ì—¬ê¸°ì— ë³´ê´€ëœ ê°’ íƒ€ì…ì˜ ê°’ì´ ë³€ê²½ë˜ë©´ ë°ì´í„°ë² ì´ìŠ¤ì— ìˆëŠ” ì›ë³¸ ë°ì´í„°ë¥¼ ì°¾ê¸° ì–´ë ¤ì›€

+ JPA êµ¬í˜„ì²´ë“¤ì€ ê°’ íƒ€ì… ì»¬ë ‰ì…˜ì— ë³€ê²½ì´ ë°œìƒí•˜ë©´ ì—°ê´€ëœ ë°ì´í„°ë¥¼ ì‚­ì œ í›„ ë‹¤ì‹œ ì €ì¥

```sql
DELETE FROM ADDRESS WHERE MEMBER_ID = 100
INSERT INTO ADDRESS(MEMBER_ID, CITY, STREET, ZIPCODE)
		VALUES (100, ...)
INSERT INTO ADDRESS(MEMBER_ID, CITY, STREET, ZIPCODE)
		VALUES (100, ...)
```

- ê°’ íƒ€ì… ì»¬ë ‰ì…˜ì´ ë§¤í•‘ëœ í…Œì´ë¸”ì— ë°ì´í„°ê°€ ë§ìœ¼ë©´ ê°’ íƒ€ì… ì»¬ë ‰ì…˜ ëŒ€ì‹  ì¼ëŒ€ë‹¤ ê´€ê³„ë¥¼ ê³ ë ¤

- ê°’ íƒ€ì… ì»¬ë ‰ì…˜ì€ **ëª¨ë“  ì»¬ëŸ¼ì„ ë¬¶ì–´ì„œ ê¸°ë³¸ í‚¤ë¡œ êµ¬ì„±ì´ í•„ìˆ˜** ê¸°ë³¸ í‚¤ ì œì•½ ì¡°ê±´ìœ¼ë¡œ ì¸í•´ **ì»¬ëŸ¼ì— nullì„ ì…ë ¥í•  ìˆ˜ ì—†ê³ ** **ì¤‘ë³µ ì €ì¥ë„ í•  ìˆ˜ ì—†ëŠ” ì œì•½ ë°œìƒ**ê°’ íƒ€ì… ì»¬ë ‰ì…˜ ëŒ€ì‹  ì¼ëŒ€ë‹¤ ê´€ê³„ ì‚¬ìš©

```java
//ê°’ íƒ€ì… ì»¬ë ‰ì…˜ ëŒ€ì‹ ì— ì¼ëŒ€ë‹¤ ê´€ê³„ ì‚¬ìš©
@Entity
public class AddressEntity {
		
    	@Id 
    	@GeneratedValue
		private Long id;

		@Embedded Address address;
		...
}

//Member
@OneToMany(cascade = CascadeType.ALL, orphanRemoval = true) // ì´ë¥¼ ì´ìš©í•´ì„œ ê°’ íƒ€ì… ì»¬ë ‰ì…˜ ì²˜ëŸ¼ ì‚¬ìš© ê°€ëŠ¥
@JoinColumn(name = "MEMBER_ID")
private List<AddressEntity> addressHistory = new ArrayList<AddressEntity>();
```



#### ì—”í‹°í‹° íƒ€ì…ì˜ íŠ¹ì§•

- ì‹ë³„ì(@Id) ì¡´ì¬

- ìƒëª… ì£¼ê¸°ê°€ ì¡´ì¬
  - ìƒì„±í•˜ê³ , ì˜ì†í™”í•˜ê³ , ì†Œë©¸í•˜ëŠ” ìƒì„± ì£¼ê¸°ê°€ ì¡´ì¬

- ê³µìœ ê°€ ê°€ëŠ¥
  - ì°¸ì¡° ê°’ì„ ê³µìœ  (ê³µìœ  ì°¸ì¡°)



#### ê°’ íƒ€ì…ì˜ íŠ¹ì§•

- ì‹ë³„ìê°€ ì—†ìŒ

- ìƒëª… ì£¼ê¸°ë¥¼ ì—”í‹°í‹°ì— ì˜ì¡´
  - ì˜ì¡´í•˜ëŠ” ì—”í‹°í‹°ë¥¼ ì œê±°í•˜ë©´ ê°™ì´ ì œê±°

- ê³µìœ í•˜ì§€ ì•ŠëŠ” ê²ƒì´ ì•ˆì „

  - ê³µìœ í•˜ì§€ ì•ŠëŠ” ê²ƒì´ ì•ˆì „í•˜ë©°, ê°’ì„ ë³µì‚¬í•´ì„œ ì‚¬ìš©

  - ì˜¤ì§ í•˜ë‚˜ì˜ ì£¼ì¸ë§Œì´ ê´€ë¦¬

  - ë¶ˆë³€ ê°ì²´ë¡œ ë§Œë“œëŠ” ê²ƒì´ ì•ˆì „