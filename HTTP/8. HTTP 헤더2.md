# HTTP ν—¤λ”2

## 1. μΊμ‹ κΈ°λ³Έ λ™μ‘

<img src="C:\Users\LG\AppData\Roaming\Typora\typora-user-images\image-20220624103303517.png" alt="image-20220624103303517" style="zoom:75%;" /><img src="C:\Users\LG\AppData\Roaming\Typora\typora-user-images\image-20220624103409662.png" alt="image-20220624103409662" style="zoom:75%;" />

### μΊμ‹κ°€ μ—†μ„ λ• 

+ λ°μ΄ν„°κ°€ λ³€κ²½λμ§€ μ•μ•„λ„ κ³„μ† λ„¤νΈμ›ν¬λ¥Ό ν†µν•΄μ„ λ°μ΄ν„°λ¥Ό λ‹¤μ΄λ΅λ“ λ°›μ•„μ•Ό ν•λ‹¤. 
+ μΈν„°λ„· λ„¤νΈμ›ν¬λ” λ§¤μ° λλ¦¬κ³  λΉ„μ‹Έλ‹¤. 
+ λΈλΌμ°μ € λ΅λ”© μ†λ„κ°€ λλ¦¬λ‹¤. 
+ λλ¦° μ‚¬μ©μ κ²½ν—



<img src="C:\Users\LG\AppData\Roaming\Typora\typora-user-images\image-20220624103528818.png" alt="image-20220624103528818" style="zoom:75%;" /><img src="C:\Users\LG\AppData\Roaming\Typora\typora-user-images\image-20220624103555449.png" alt="image-20220624103555449" style="zoom:75%;" />

<img src="C:\Users\LG\AppData\Roaming\Typora\typora-user-images\image-20220624103617006.png" alt="image-20220624103617006" style="zoom:75%;" /><img src="C:\Users\LG\AppData\Roaming\Typora\typora-user-images\image-20220624103645606.png" alt="image-20220624103645606" style="zoom:75%;" />



### μΊμ‹ μ μ© 

+ **μΊμ‹μ— μ‘λ‹µ κ²°κ³Ό μ €μ¥**
+ μΊμ‹ λ•λ¶„μ— μΊμ‹ κ°€λ¥ μ‹κ°„λ™μ• λ„¤νΈμ›ν¬λ¥Ό μ‚¬μ©ν•μ§€ μ•μ•„λ„ λλ‹¤. 
+ λΉ„μ‹Ό λ„¤νΈμ›ν¬ μ‚¬μ©λ‰μ„ μ¤„μΌ μ μλ‹¤. 
+ λΈλΌμ°μ € λ΅λ”© μ†λ„κ°€ λ§¤μ° λΉ λ¥΄λ‹¤. 
+ λΉ λ¥Έ μ‚¬μ©μ κ²½ν—



<img src="C:\Users\LG\AppData\Roaming\Typora\typora-user-images\image-20220624104110818.png" alt="image-20220624104110818" style="zoom:50%;" /><img src="C:\Users\LG\AppData\Roaming\Typora\typora-user-images\image-20220624104159221.png" alt="image-20220624104159221" style="zoom:50%;" />

<img src="C:\Users\LG\AppData\Roaming\Typora\typora-user-images\image-20220624104328516.png" alt="image-20220624104328516" style="zoom:55%;" align="left"/>



### μΊμ‹ μ‹κ°„ μ΄κ³Ό 

+ μΊμ‹ μ ν¨ μ‹κ°„μ΄ μ΄κ³Όν•λ©΄, μ„λ²„λ¥Ό ν†µν•΄ λ°μ΄ν„°λ¥Ό λ‹¤μ‹ μ΅°νν•κ³ , μΊμ‹λ¥Ό κ°±μ‹ ν•λ‹¤. 
+ μ΄λ• λ‹¤μ‹ λ„¤νΈμ›ν¬ λ‹¤μ΄λ΅λ“κ°€ λ°μƒν•λ‹¤.

----

## 2. κ²€μ¦ ν—¤λ”μ™€ μ΅°κ±΄λ¶€ μ”μ²­ 1

### μΊμ‹ μ‹κ°„ μ΄κ³Ό - Last-Modified μ¶”κ°€ν•΄μ„ ν•΄κ²°

+ μΊμ‹ μ ν¨ μ‹κ°„μ΄ μ΄κ³Όν•΄μ„ μ„λ²„μ— λ‹¤μ‹ μ”μ²­ν•λ©΄ λ‹¤μ λ‘ κ°€μ§€ μƒν™©μ΄ λ‚νƒ€λ‚λ‹¤. 

  1. μ„λ²„μ—μ„ κΈ°μ΅΄ λ°μ΄ν„°λ¥Ό λ³€κ²½ν•¨  		     β­ β†’ π

  2. μ„λ²„μ—μ„ κΈ°μ΅΄ λ°μ΄ν„°λ¥Ό λ³€κ²½ν•μ§€ μ•μ   β­



+ μΊμ‹ λ§λ£ν›„μ—λ„ μ„λ²„μ—μ„ λ°μ΄ν„°λ¥Ό λ³€κ²½ν•μ§€ μ•μ  β­

+ μƒκ°ν•΄λ³΄λ©΄ λ°μ΄ν„°λ¥Ό μ „μ†΅ν•λ” λ€μ‹ μ— μ €μ¥ν•΄ λ‘μ—λ μΊμ‹λ¥Ό μ¬μ‚¬μ© ν•  μ μλ‹¤. 
+ λ‹¨ ν΄λΌμ΄μ–ΈνΈμ λ°μ΄ν„°μ™€ μ„λ²„μ λ°μ΄ν„°κ°€ κ°™λ‹¤λ” μ‚¬μ‹¤μ„ ν™•μΈν•  μ μλ” λ°©λ²• ν•„μ”



<img src="C:\Users\LG\AppData\Roaming\Typora\typora-user-images\image-20220624105026906.png" alt="image-20220624105026906" style="zoom:50%;" /><img src="C:\Users\LG\AppData\Roaming\Typora\typora-user-images\image-20220624105059005.png" alt="image-20220624105059005" style="zoom:50%;" />

<img src="C:\Users\LG\AppData\Roaming\Typora\typora-user-images\image-20220624105555421.png" alt="image-20220624105555421" style="zoom:50%;" /><img src="C:\Users\LG\AppData\Roaming\Typora\typora-user-images\image-20220624105611773.png" alt="image-20220624105611773" style="zoom:50%;" />

<img src="C:\Users\LG\AppData\Roaming\Typora\typora-user-images\image-20220624105753827.png" alt="image-20220624105753827" style="zoom:45%;" /><img src="C:\Users\LG\AppData\Roaming\Typora\typora-user-images\image-20220624105818814.png" alt="image-20220624105818814" style="zoom:45%;" />

<img src="C:\Users\LG\AppData\Roaming\Typora\typora-user-images\image-20220624105926940.png" alt="image-20220624105926940" style="zoom:50%;" align="left"/>





### κ²€μ¦ ν—¤λ”μ™€ μ΅°κ±΄λ¶€ μ”μ²­ μ •λ¦¬ 

+ μΊμ‹ μ ν¨ μ‹κ°„μ΄ μ΄κ³Όν•΄λ„, μ„λ²„μ λ°μ΄ν„°κ°€ κ°±μ‹ λμ§€ μ•μΌλ©΄ 
+ **304 Not Modified** + ν—¤λ” λ©”νƒ€ μ •λ³΄λ§ μ‘λ‹µ**(λ°”λ””X)** 
+ ν΄λΌμ΄μ–ΈνΈλ” μ„λ²„κ°€ λ³΄λ‚Έ **μ‘λ‹µ ν—¤λ” μ •λ³΄λ΅ μΊμ‹μ λ©”νƒ€ μ •λ³΄λ¥Ό κ°±μ‹ ** 
+ ν΄λΌμ΄μ–ΈνΈλ” μΊμ‹μ— μ €μ¥λμ–΄ μλ” **λ°μ΄ν„° μ¬ν™μ©** 
+ κ²°κ³Όμ μΌλ΅ λ„¤νΈμ›ν¬ λ‹¤μ΄λ΅λ“κ°€ λ°μƒν•μ§€λ§ μ©λ‰μ΄ μ μ€ ν—¤λ” μ •λ³΄λ§ λ‹¤μ΄λ΅λ“ 
+ λ§¤μ° μ‹¤μ©μ μΈ ν•΄κ²°μ±…

--------------

## 3. κ²€μ¦ ν—¤λ”μ™€ μ΅°κ±΄λ¶€ μ”μ²­2

+ κ²€μ¦ ν—¤λ” 
  + μΊμ‹ λ°μ΄ν„°μ™€ μ„λ²„ λ°μ΄ν„°κ°€ κ°™μ€μ§€ κ²€μ¦ν•λ” λ°μ΄ν„° 
  + Last-Modified , ETag 
+ μ΅°κ±΄λ¶€ μ”μ²­ ν—¤λ” 
  + κ²€μ¦ ν—¤λ”λ΅ μ΅°κ±΄μ— λ”°λ¥Έ λ¶„κΈ° 
  + If-Modified-Since: Last-Modified μ‚¬μ© 
  + If-None-Match: ETag μ‚¬μ© 
  + μ΅°κ±΄μ΄ λ§μ΅±ν•λ©΄ 200 OK 
  + μ΅°κ±΄μ΄ λ§μ΅±ν•μ§€ μ•μΌλ©΄ 304 Not Modified



**μμ‹**

+ If-Modified-Since: μ΄ν›„μ— λ°μ΄ν„°κ°€ μμ •λμ—μΌλ©΄? 
  + λ°μ΄ν„° λ―Έλ³€κ²½ μμ‹ 
    + μΊμ‹: 2020λ…„ 11μ›” 10μΌ 10:00:00 vs μ„λ²„: 2020λ…„ 11μ›” 10μΌ 10:00:00 
    + **304 Not Modified, ν—¤λ” λ°μ΄ν„°λ§ μ „μ†΅(BODY λ―Έν¬ν•¨)** 
    + **μ „μ†΅ μ©λ‰ 0.1M** (ν—¤λ” 0.1M, λ°”λ”” 1.0M) 
  + λ°μ΄ν„° λ³€κ²½ μμ‹ 
    + μΊμ‹: 2020λ…„ 11μ›” 10μΌ 10:00:00 vs μ„λ²„: 2020λ…„ 11μ›” 10μΌ 11:00:00 
    + **200 OK, λ¨λ“  λ°μ΄ν„° μ „μ†΅(BODY ν¬ν•¨)** 
    + **μ „μ†΅ μ©λ‰ 1.1M** (ν—¤λ” 0.1M, λ°”λ”” 1.0M)



### Last-Modified, If-Modified-Since λ‹¨μ 

+ 1μ΄ λ―Έλ§(0.xμ΄) λ‹¨μ„λ΅ μΊμ‹ μ΅°μ •μ΄ λ¶κ°€λ¥ 
+ λ‚ μ§ κΈ°λ°μ λ΅μ§ μ‚¬μ© 
+ λ°μ΄ν„°λ¥Ό μμ •ν•΄μ„ λ‚ μ§κ°€ λ‹¤λ¥΄μ§€λ§, κ°™μ€ λ°μ΄ν„°λ¥Ό **μμ •ν•΄μ„ λ°μ΄ν„° κ²°κ³Όκ°€ λ‘κ°™μ€ κ²½μ°** 
+ μ„λ²„μ—μ„ λ³„λ„μ μΊμ‹ λ΅μ§μ„ κ΄€λ¦¬ν•κ³  μ‹¶μ€ κ²½μ° 
  + μ) μ¤νμ΄μ¤λ‚ μ£Όμ„μ²λΌ ν¬κ² μν–¥μ΄ μ—†λ” λ³€κ²½μ—μ„ μΊμ‹λ¥Ό μ μ§€ν•κ³  μ‹¶μ€ κ²½μ°



### ETag, If-None-Match

+ ETag(Entity Tag) 
+ μΊμ‹μ© λ°μ΄ν„°μ— **μ„μμ κ³ μ ν• λ²„μ „** μ΄λ¦„μ„ λ‹¬μ•„λ‘  
  + μ) ETag: "v1.0", ETag: "a2jiodwjekjl3" 
+ **λ°μ΄ν„°κ°€ λ³€κ²½λλ©΄ μ΄ μ΄λ¦„μ„ λ°”κΎΈμ–΄μ„ λ³€κ²½ν•¨(Hashλ¥Ό λ‹¤μ‹ μƒμ„±)** 
  + μ) ETag: "aaaaa" -> ETag: "bbbbb" 
+ μ§„μ§ λ‹¨μν•κ² ETagλ§ λ³΄λ‚΄μ„ κ°™μΌλ©΄ μ μ§€, λ‹¤λ¥΄λ©΄ λ‹¤μ‹ λ°›κΈ°!



<img src="C:\Users\LG\AppData\Roaming\Typora\typora-user-images\image-20220624111355290.png" alt="image-20220624111355290" style="zoom:75%;" /><img src="C:\Users\LG\AppData\Roaming\Typora\typora-user-images\image-20220624111416939.png" alt="image-20220624111416939" style="zoom:75%;" />

<img src="C:\Users\LG\AppData\Roaming\Typora\typora-user-images\image-20220624111500051.png" alt="image-20220624111500051" style="zoom:75%;" /><img src="C:\Users\LG\AppData\Roaming\Typora\typora-user-images\image-20220624111524371.png" alt="image-20220624111524371" style="zoom:75%;" />

<img src="C:\Users\LG\AppData\Roaming\Typora\typora-user-images\image-20220624111551424.png" alt="image-20220624111551424" style="zoom:70%;" /><img src="C:\Users\LG\AppData\Roaming\Typora\typora-user-images\image-20220624111625754.png" alt="image-20220624111625754" style="zoom:70%;" />

<img src="C:\Users\LG\AppData\Roaming\Typora\typora-user-images\image-20220624111708892.png" alt="image-20220624111708892" style="zoom:75%;" align="left"/>



### ETag, If-None-Match

+ μ§„μ§ λ‹¨μν•κ² ETagλ§ μ„λ²„μ— λ³΄λ‚΄μ„ κ°™μΌλ©΄ μ μ§€, λ‹¤λ¥΄λ©΄ λ‹¤μ‹ λ°›κΈ°! 
+ **μΊμ‹ μ μ–΄ λ΅μ§μ„ μ„λ²„μ—μ„ μ™„μ „ν κ΄€λ¦¬** 
+ ν΄λΌμ΄μ–ΈνΈλ” λ‹¨μν μ΄ κ°’μ„ μ„λ²„μ— μ κ³µ**(ν΄λΌμ΄μ–ΈνΈλ” μΊμ‹ λ©”μ»¤λ‹μ¦μ„ λ¨λ¦„)** 
+ μ) 
  + μ„λ²„λ” λ°°νƒ€ μ¤ν” κΈ°κ°„μΈ 3μΌ λ™μ• νμΌμ΄ λ³€κ²½λμ–΄λ„ ETagλ¥Ό λ™μΌν•κ² μ μ§€ 
  + μ• ν”λ¦¬μΌ€μ΄μ… λ°°ν¬ μ£ΌκΈ°μ— λ§μ¶”μ–΄ ETag λ¨λ‘ κ°±μ‹ 

---

## 4. μΊμ‹ μ μ–΄ ν—¤λ”

### 4-1. Cache-Control 

> μΊμ‹ μ§€μ‹μ–΄(directives) 

+ Cache-Control: max-age 
  + μΊμ‹ μ ν¨ μ‹κ°„, μ΄ λ‹¨μ„ 
  + μΊμ‹κ°€ μ–Όλ§λ™μ• μ ν¨ν•  κ²ƒμ΄λƒ
+ Cache-Control: no-cache 
  + λ°μ΄ν„°λ” μΊμ‹ν•΄λ„ λμ§€λ§, **ν•­μƒ μ›(origin) μ„λ²„μ— κ²€μ¦ν•κ³  μ‚¬μ©** 
+ Cache-Control: no-store 
  + λ°μ΄ν„°μ— λ―Όκ°ν• μ •λ³΄κ°€ μμΌλ―€λ΅ μ €μ¥ν•λ©΄ μ•λ¨ (λ©”λ¨λ¦¬μ—μ„ μ‚¬μ©ν•κ³  μµλ€ν• λΉ¨λ¦¬ μ‚­μ )
+ κΈ°νƒ€ 
  + Cache-Control: public  
    + μ‘λ‹µμ΄ public μΊμ‹μ— μ €μ¥λμ–΄λ„ λ¨ 
  + Cache-Control: private  
    + **μ‘λ‹µμ΄ ν•΄λ‹Ή μ‚¬μ©μλ§μ„ μ„ν• κ²ƒ**μ„, private μΊμ‹μ— μ €μ¥ν•΄μ•Ό ν•¨(κΈ°λ³Έκ°’) 
  + Cache-Control: s-maxage  
    + **ν”„λ΅μ‹ μΊμ‹μ—λ§ μ μ©λλ” max-age** 
  + Age: 60 (HTTP ν—¤λ”) 
    + μ¤λ¦¬μ§„ μ„λ²„μ—μ„ μ‘λ‹µ ν›„ ν”„λ΅μ‹ μΊμ‹ λ‚΄μ— λ¨Έλ¬Έ μ‹κ°„(μ΄)





### 4-2. Pragma 

> μΊμ‹ μ μ–΄(ν•μ„ νΈν™) 

+ Pragma: no-cache 
+ HTTP 1.0 ν•μ„ νΈν™
+ ν„μ¬ κ±°μ μ‚¬μ© x



### 4-3. Expires 

> μΊμ‹ λ§λ£μΌ μ§€μ •(ν•μ„ νΈν™) 

+ expires: Mon, 01 Jan 1990 00:00:00 GMT 



+ **μΊμ‹ λ§λ£μΌμ„ μ •ν™•ν• λ‚ μ§λ΅ μ§€μ •** 
+ HTTP 1.0 λ¶€ν„° μ‚¬μ© 
+ μ§€κΈμ€ λ” μ μ—°ν• Cache-Control: max-age κ¶μ¥ 
+ Cache-Control: max-ageμ™€ ν•¨κ» μ‚¬μ©ν•λ©΄ Expiresλ” λ¬΄μ‹



### μ •λ¦¬

> κ²€μ¦ ν—¤λ”μ™€ μ΅°κ±΄λ¶€ μ”μ²­ ν—¤λ” 

**κ²€μ¦ ν—¤λ” (Validator)**  

+ **ETag**: "v1.0", ETag: "asid93jkrh2l" 

+ **Last-Modified**: Thu, 04 Jun 2020 07:19:24 GMT 

**μ΅°κ±΄λ¶€ μ”μ²­ ν—¤λ”** 

+ **If-Match, If-None-Match**: **ETag** κ°’ μ‚¬μ© 
+ **If-Modified-Since, If-Unmodified-Since**: **Last-Modified** κ°’ μ‚¬μ©



-----

## 5. ν”„λ΅μ‹ μΊμ‹



### μ› μ„λ²„ μ§μ ‘ μ ‘κ·Ό

<img src="C:\Users\LG\AppData\Roaming\Typora\typora-user-images\image-20220625150834962.png" alt="image-20220625150834962" style="zoom:80%;" align="left"/>



### ν”„λ΅μ‹ μΊμ‹ λ„μ…

<img src="C:\Users\LG\AppData\Roaming\Typora\typora-user-images\image-20220625150921687.png" alt="image-20220625150921687" style="zoom:70%;" align="left"/><img src="C:\Users\LG\AppData\Roaming\Typora\typora-user-images\image-20220625151003769.png" alt="image-20220625151003769" style="zoom:70%;" />



----

## 6. μΊμ‹ λ¬΄ν¨ν™”

### Cache-Control 

> **ν™•μ‹¤ν• μΊμ‹ λ¬΄ν¨ν™” μ‘λ‹µ** 
>
> μ–΄λ–¤ νΉμ • νμ΄μ§€μ— μΊμ‹κ°€ μ λ€ λ“¤μ–΄κ°€λ©΄ μ•λ  κ²½μ° μ•„λμ λ‚΄μ©μ„ μ „λ¶€ λ‹¤ μ‘μ„±ν•μ—¬ μ‚¬μ©

+ Cache-Control: no-cache, no-store, must-revalidate  
+ Pragma: no-cache  
  + HTTP 1.0 ν•μ„ νΈν™



#### Cache-Control: no-cache  

+ λ°μ΄ν„°λ” μΊμ‹ν•΄λ„ λμ§€λ§, ν•­μƒ **μ› μ„λ²„μ— κ²€μ¦**ν•κ³  μ‚¬μ©(μ΄λ¦„μ— μ£Όμ!) 

#### Cache-Control: no-store  

+ λ°μ΄ν„°μ— λ―Όκ°ν• μ •λ³΄κ°€ μμΌλ―€λ΅ **μ €μ¥ν•λ©΄ μ•λ¨** (λ©”λ¨λ¦¬μ—μ„ μ‚¬μ©ν•κ³  μµλ€ν• λΉ¨λ¦¬ μ‚­μ ) 

#### Cache-Control: must-revalidate  

+ μΊμ‹ λ§λ£ν›„ μµμ΄ μ΅°νμ‹ **μ› μ„λ²„μ— κ²€μ¦**ν•΄μ•Όν•¨ 

+ μ› μ„λ²„ μ ‘κ·Ό μ‹¤ν¨μ‹ λ°λ“μ‹ μ¤λ¥κ°€ λ°μƒν•΄μ•Όν•¨ - 504(Gateway Timeout) 

+ must-revalidateλ” μΊμ‹ μ ν¨ μ‹κ°„μ΄λΌλ©΄ μΊμ‹λ¥Ό μ‚¬μ©ν•¨ 

#### Pragma: no-cache  

+ HTTP 1.0 ν•μ„ νΈν™



### no-cacheμ™€ must-revalidate μ°¨μ΄μ 

#### no-cache κΈ°λ³Έ λ™μ‘

<img src="C:\Users\LG\AppData\Roaming\Typora\typora-user-images\image-20220625152015103.png" alt="image-20220625152015103" style="zoom:80%;" align="left"/>

<img src="C:\Users\LG\AppData\Roaming\Typora\typora-user-images\image-20220625152228115.png" alt="image-20220625152228115" style="zoom:80%;" align="left"/>

+ no-cacheμΈ μƒνƒμ—μ„ ν”„λ΅μ‹ μΊμ‹ μ„λ²„κ°€ μ›μ„λ²„μ™€ μ—°κ²°ν•λ ¤λ‹¤ μκ°„ λ‹¨μ  μ‹ μ¤λ¥κ°€ μ•„λ‹ μ¤λλ λ°μ΄ν„°λ¥Ό λ³΄μ—¬μ¤



#### must-revalidate

<img src="C:\Users\LG\AppData\Roaming\Typora\typora-user-images\image-20220625152420271.png" alt="image-20220625152420271" style="zoom:100%;" align="left"/>

+ ν”„λ΅μ‹ μΊμ‹ μ„λ²„κ°€ μ›μ„λ²„μ™€ μ—°κ²°ν•λ ¤λ‹¤ μκ°„ λ‹¨μ λμ—λ‹¤κ³  ν•΄μ„ μ›λ‚  μΊμ‹λ¥Ό μ“°λ” κ²ƒμ΄ μ•„λ‹ λ¬΄μ΅°κ±΄ μ¤λ¥λ¥Ό λ°μƒμ‹ν‚΄